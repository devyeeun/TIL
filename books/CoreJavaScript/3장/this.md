# 코어자바스크립트(위키북스)


## 3장 - this

### this
this는 자바스크립트에서 가장 혼란스럽고 어려운 개념 중 하나이다.  
자바스크립트에서의 this는 어디서든 사용할 수 있다.  
this는 함수가 호출될 때마다 다르게 바인딩된다.(상황에 따라 this가 바라보는 대상이 달라진다.)

자바스크립트에서 this는 기본적으로 실행 컨텍스트가 생성될 때 함께 결정된다.
즉, **this는 함수를 호출할 때 결정된다!**
함수를 어떤 방식으로 호출하느냐에 따라 값이 달라지는 것.


#### 전역공간에서의 this
전역공간에서 this는 전역 객체를 가리킨다.  
브라우저에서는 window 객체가 전역 객체이므로 this는 window를 가리킨다.  
(전역 객체는 자바스크립트 런타임 환경에 따라 다른 이름과 정보를 지닌다.)

```javascript
console.log(this); // window
console.log(window); // window
console.log(this === window); // true
```

--- 
> ***참고***:   
> 전역변수를 선언하면 JS엔진은 이를 전역객체의 프로퍼티로도 만든다. 변수이면서 객체의 프로퍼티이기도 하다.

```javascript
var a = 1;
console.log(a); // 1
console.log(window.a); // 1
console.log(this.a); // 1
```

자바스크립트의 모든 변수는 특정 객체의 프로퍼티로서 동작하기 때문에 전부 값이 1인 것.

---

#### 메소드로서 호출될 때의 this

함수를 실행하는 방법 :  
1. 일반 함수로서 호출
2. 메소드로서 호출

이 둘을 구분하는 유일한 차이는 **독립성**이다.
함수는 그 자체로 독립적인 기능을 수행하는 반면, 메소드는 자신을 호출한 객체에 종속적이다.

메서드를 객체의 프로퍼티에 할당된 함수로 이해하지만, 사실은 어떤 함수를 객체의 프로퍼티에 할당한다고 해서 그 자체로서 무조건 메서드가 되는 것이 아니라 객체의 메서드로서 호출할 경우에만 메서드로 동작하고 그렇지 않으면 함수로 동작한다.

```javascript
var func = function(x) {
    console.log(this, x);
};

func(1); // window {...}, 1

var obj = {
    method : func
}

obj.method(2); // {method: ƒ} 2
```

원래의 익명함수는 그대로인데 이를 변수에 담아서 호출한 경우와 obj 객체의 프로퍼티에 할당해서 호출한 경우에 this가 달라진다.

그렇다면 이걸 어떻게 구분할까?
> 함수 앞에 점(.)이 붙어있으면 메서드로서 호출된 것이다.  
(대괄호 표기법에 따른 경우에도 메서드로 호출한 것은 마찬가지)

```javascript
var obj = {
    method : function(x) {
        console.log(this, x);
    }
}

obj.method(3); // {method: ƒ} 3
obj['method'](4); // {method: ƒ} 4
```

어떤 함수를 호출할 때 그 함수 이름(프로퍼티명) 앞에 객체가 명시돼 있는 경우에는 메서드로 호출한 것이고, 그렇지 않은 모든 경우에는 함수로 호출한 것!

---

#### 메서드 내부에서의 this
this에는 호출한 객체가 바인딩된다.(호출한 주체에 대한 정보가 담긴다.)
호출 주체는 바로 함수명(프로퍼티명) 앞의 객체이다.


#### 함수로서 호출될 때의 this
